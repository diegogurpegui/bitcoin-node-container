################################################################################
#                                                                              #
#                   Bitcoin Core Configuration - TEMPLATE                      #
#                                                                              #
################################################################################
#
# This is a reference template. Run ./setup.sh to automatically create
# a properly configured bitcoin.conf with secure rpcauth in your data directory.
#
# Based on RaspiBolt configuration best practices
# https://raspibolt.org/guide/bitcoin/bitcoin-client.html#configuration
#
################################################################################


################################################################################
# NETWORK SETTINGS
################################################################################

# Run on mainnet (default)
#testnet=1  # Uncomment for testnet
#regtest=1  # Uncomment for regtest


################################################################################
# CONNECTION SETTINGS
################################################################################

server=1
listen=1

# Connection optimization
# For full nodes serving the network, 40-125 connections is reasonable
# More connections = more bandwidth usage but better network contribution
maxconnections=80

# Whitelist local connections for better reliability
# Allow connections from Docker network
whitelist=172.0.0.0/8

# Support filtering of blocks and transactions with bloom filters.
peerbloomfilters=0

# ------------------------------------------------------------------------------
# TOR CONFIGURATION
# ------------------------------------------------------------------------------

# Connect only via Tor for privacy
# Based on: https://raspibolt.org/guide/bitcoin/bitcoin-client.html
# All connections (IPv4, IPv6, onion) are routed through Tor SOCKS5 proxy
proxy=127.0.0.1:9050

# Bind to all interfaces to allow electrs container to connect
# Note: This is needed for electrs to connect via Docker networking
bind=0.0.0.0

# Create and advertise a Tor hidden service for incoming connections
listenonion=1

# Disable local service discovery to prevent clearnet exposure
discover=0

# Only connect to .onion addresses (optional but recommended for Tor-only mode)
# This ensures no accidental clearnet connections
# onlynet=onion


################################################################################
# BLOCKCHAIN & INDEXING
################################################################################

# Transaction index (required for some applications like block explorers)
# NOTE: This requires reindexing the entire blockchain if enabled after initial sync
txindex=1

# Initial Blockchain Download optimization (OPTIONAL)
# During initial sync, you can temporarily enable blocksonly=1 to speed up sync
# This downloads only blocks without mempool transactions
# Uncomment the line below ONLY during initial sync, then comment it out again
#blocksonly=1

# # Relay transactions with OP_RETURN outputs.
# datacarrier=1
# # Maximum size of data in OP_RETURN outputs we relay and mine.
# datacarriersize=83


################################################################################
# RPC SETTINGS
################################################################################

# Using rpcauth for security
# Example rpcauth line:
#   rpcauth=bitcoin:1a2b3c4d$e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6
#
# IMPORTANT: 
# - The password is NOT stored in bitcoin.conf (only the hash)
# - Store the password separately (e.g., in .env for bitcoin-cli)
# - Each client (bitcoin-cli, Lightning, etc.) needs the plain password

# Placeholder - setup.sh will generate the actual rpcauth line
rpcauth=bitcoin:SETUP_SCRIPT_WILL_GENERATE_THIS

rpcallowip=127.0.0.1
rpcallowip=172.0.0.0/8
rpcallowip=172.16.0.0/12
rpcallowip=192.168.0.0/16
rpcbind=0.0.0.0


################################################################################
# PERFORMANCE & MEMORY
################################################################################

# Database cache size (MB)
# Higher cache speeds up initial blockchain download
# During sync: Use 2000-4000 MB (or more if you have RAM available)
# After sync: Reduce to 450-1000 MB for normal operation
# Full nodes benefit from larger cache for better performance
dbcache=4000

# Mempool settings
maxmempool=300
mempoolexpiry=72

# Optimize signature cache for better performance
maxsigcachesize=400


################################################################################
# LOGGING
################################################################################

debug=0
printtoconsole=1


################################################################################
# ZMQ NOTIFICATIONS
################################################################################

# Useful for applications that need real-time updates
# Uncomment if you need real-time block/transaction notifications
# These are required by some applications like LND, Electrs, BTCPay Server
#zmqpubrawblock=tcp://0.0.0.0:28332
#zmqpubrawtx=tcp://0.0.0.0:28333
#zmqpubhashblock=tcp://0.0.0.0:28334

################################################################################
# WALLET SETTINGS
################################################################################

# Allow creation of legacy wallets (required for JoinMarket)
deprecatedrpc=create_bdb
